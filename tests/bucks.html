
<script>
let timeSpentOnPage = parseInt(localStorage.getItem('timeSpent'), 10) || 0;
let interval;

document.addEventListener('visibilitychange', function() {
  if (document.visibilityState === 'visible') {
    // Start or resume the timer
    interval = setInterval(() => {
      timeSpentOnPage++;
      localStorage.setItem('timeSpent', timeSpentOnPage.toString());
    }, 1000); // Changed to 1 second for better performance
  } else {
    // Pause the timer
    clearInterval(interval);
  }
});

window.addEventListener('beforeunload', function() {
  // Save the final values before leaving the page
  clearInterval(interval);
  const minutes = Math.floor(timeSpentOnPage / 60);
  const finalValue = Math.floor(minutes / 3);
  localStorage.setItem('finalValue', finalValue.toString());
  localStorage.setItem('minutes', minutes.toString());
  localStorage.setItem('timeSpentOnPage', timeSpentOnPage.toString());
});

window.addEventListener('load', function() {
  // Display the saved values when the page is loaded
  const savedFinalValue = localStorage.getItem('finalValue');
  const savedMinutes = localStorage.getItem('minutes');
  const savedTimeSpent = localStorage.getItem('timeSpentOnPage');
  if (savedFinalValue) {
    const pElement = document.createElement('p');
    pElement.textContent = `Last session time: ${savedFinalValue}:${savedMinutes}:${savedTimeSpent} units`;
    document.body.appendChild(pElement);
  }
});

</script>
